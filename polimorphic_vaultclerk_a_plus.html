<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polimorphic + VAULTCLERK‚Ñ¢ | Integrated Workflow System (A+)</title>
    <!--
      This A+ version of the municipal licensing workflow page incorporates
      accessibility and performance fixes. Notable improvements include:
      ‚Ä¢ Removal of stray backtick code fences.
      ‚Ä¢ Proper roles and ARIA attributes for interactive elements.
      ‚Ä¢ Modern semantic navigation and live region for announcements.
      ‚Ä¢ Reduced‚Äëmotion support and throttled scroll handling.
      ‚Ä¢ Enhanced color contrast for decision elements.
    -->
    <style>
        /* Base reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .control-panel {
            background: #1e293b;
            padding: 20px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .mode-toggle {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .toggle-btn {
            background: #334155;
            color: white;
            border: 2px solid #475569;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .toggle-btn:hover {
            background: #475569;
            transform: translateY(-2px);
        }

        .toggle-btn.active {
            background: #3b82f6;
            border-color: #3b82f6;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }

        .view-controls {
            display: flex;
            gap: 10px;
        }

        .control-btn {
            background: transparent;
            color: white;
            border: 2px solid #475569;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            border-color: #3b82f6;
            color: #3b82f6;
        }

        .metrics-dashboard {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            padding: 30px 40px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            border-bottom: 3px solid #0ea5e9;
        }

        .metric-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .metric-value {
            font-size: 2.5em;
            font-weight: 700;
            color: #0c4a6e;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.9em;
            color: #075985;
            font-weight: 600;
        }

        .metric-trend {
            font-size: 0.8em;
            color: #059669;
            margin-top: 5px;
        }

        .legend {
            background: #f8fafc;
            padding: 30px;
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            border-bottom: 3px solid #e2e8f0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9em;
            font-weight: 600;
        }

        .legend-box {
            width: 30px;
            height: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .workflow {
            padding: 40px;
            position: relative;
        }

        /* Timeline indicator updated to nav semantics */
        .timeline-indicator {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
        }

        .timeline-indicator.visible {
            display: block;
        }

        .timeline-step {
            padding: 8px;
            margin: 5px 0;
            border-radius: 6px;
            font-size: 0.8em;
            cursor: pointer;
            transition: all 0.3s ease;
            background: transparent;
            border: none;
            text-align: left;
            width: 100%;
        }

        .timeline-step:hover {
            background: #f1f5f9;
        }

        .timeline-step.active {
            background: #3b82f6;
            color: white;
            font-weight: 600;
        }

        .flow-stage {
            margin-bottom: 40px;
            animation: fadeInUp 0.6s ease-out;
            animation-fill-mode: both;
            scroll-margin-top: 100px;
        }

        .flow-stage:nth-child(1) { animation-delay: 0.1s; }
        .flow-stage:nth-child(2) { animation-delay: 0.2s; }
        .flow-stage:nth-child(3) { animation-delay: 0.3s; }
        .flow-stage:nth-child(4) { animation-delay: 0.4s; }
        .flow-stage:nth-child(5) { animation-delay: 0.5s; }
        .flow-stage:nth-child(6) { animation-delay: 0.6s; }
        .flow-stage:nth-child(7) { animation-delay: 0.7s; }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stage-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stage-number {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .stage-title {
            font-size: 1.8em;
            font-weight: 700;
            color: #1e293b;
        }

        .stage-timing {
            margin-left: auto;
            background: #fef3c7;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            color: #92400e;
        }

        .node-container {
            display: flex;
            gap: 20px;
            align-items: stretch;
            flex-wrap: wrap;
        }

        .node {
            flex: 1;
            min-width: 250px;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .node:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.2);
        }

        .node::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, rgba(255,255,255,0.5) 0%, rgba(255,255,255,0.2) 100%);
        }

        .node-polimorphic {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .node-vault {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: white;
        }

        .node-ai {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .node-human {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .node-output {
            background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);
            color: white;
        }

        .node-archive {
            background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
            color: white;
        }

        .node-title {
            font-size: 1.3em;
            font-weight: 700;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .node-icon {
            font-size: 1.5em;
        }

        .node-description {
            font-size: 0.95em;
            line-height: 1.6;
            opacity: 0.95;
        }

        .node-detail {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(255,255,255,0.2);
            font-size: 0.85em;
            font-style: italic;
            opacity: 0.9;
        }

        .node-technical {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            display: none;
            font-family: 'Courier New', monospace;
            font-size: 0.8em;
        }

        .node-technical.visible {
            display: block;
            animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                max-height: 0;
            }
            to {
                opacity: 1;
                max-height: 500px;
            }
        }

        .technical-label {
            font-weight: 700;
            margin-top: 8px;
            margin-bottom: 4px;
            color: #fbbf24;
        }

        .code-block {
            background: rgba(0,0,0,0.3);
            padding: 8px;
            border-radius: 4px;
            margin: 5px 0;
            overflow-x: auto;
        }

        .connector {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .connector-arrow {
            font-size: 3em;
            color: #94a3b8;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        .relief-section {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            padding: 40px;
            margin: 40px 0;
            border-radius: 15px;
            border: 2px solid #0ea5e9;
        }

        .relief-title {
            font-size: 1.6em;
            font-weight: 700;
            color: #0c4a6e;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .relief-content {
            font-size: 1.1em;
            color: #075985;
            line-height: 1.8;
        }

        .relief-highlight {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
            border-left: 4px solid #0ea5e9;
        }

        .decision-point {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 3px solid #f59e0b;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .decision-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #92400e;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .decision-options {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .decision-option {
            background: white;
            padding: 15px 25px;
            border-radius: 10px;
            border: 2px solid #f59e0b;
            font-weight: 600;
            color: #92400e;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .decision-option:hover {
            background: #f59e0b;
            color: white;
            transform: scale(1.05);
        }

        .decision-option::after {
            content: attr(data-percentage);
            position: absolute;
            top: -10px;
            right: -10px;
            background: #3b82f6;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 700;
        }

        .footer {
            background: #1e293b;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .footer-logo {
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .footer-tagline {
            font-size: 1em;
            opacity: 0.8;
        }

        .keyboard-hint {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            font-size: 0.85em;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .keyboard-hint.visible {
            opacity: 1;
        }

        .print-mode {
            display: none;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
            }
            .control-panel,
            .metrics-dashboard,
            .timeline-indicator,
            .keyboard-hint {
                display: none !important;
            }
            .print-mode {
                display: block;
                page-break-before: always;
            }
            .node-technical {
                display: none !important;
            }
            .flow-stage {
                page-break-inside: avoid;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            .node-container {
                flex-direction: column;
            }
            .legend {
                flex-direction: column;
                align-items: center;
            }
            .control-panel {
                flex-direction: column;
            }
            .timeline-indicator {
                display: none !important;
            }
            .stage-timing {
                margin-left: 0;
                margin-top: 10px;
            }
        }

        /* Accessibility improvements */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #3b82f6;
            color: white;
            padding: 8px;
            text-decoration: none;
            z-index: 10000;
        }

        .skip-link:focus {
            top: 0;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Focus indicators */
        .node:focus,
        .toggle-btn:focus,
        .control-btn:focus,
        .decision-option:focus,
        .timeline-step:focus {
            outline: 3px solid #3b82f6;
            outline-offset: 2px;
        }

        /* Respect users who prefer reduced motion */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation: none !important;
                transition: none !important;
            }
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <div class="keyboard-hint" id="keyboardHint">
        <strong>Keyboard shortcuts:</strong><br>
        T = Toggle technical mode | P = Print view | ‚Üë‚Üì = Navigate stages
    </div>
    <div class="container">
        <header class="header">
            <h1>üîÑ Polimorphic + VAULTCLERK‚Ñ¢</h1>
            <p>Integrated Municipal Licensing Workflow | End-to-End Process</p>
        </header>
        <div class="control-panel">
            <div class="mode-toggle">
                <button id="techModeToggle" class="toggle-btn" aria-pressed="false">
                    <span id="techModeText">üìä Simple Mode</span>
                </button>
                <span style="color: white; font-size: 0.9em;">Toggle for technical details</span>
            </div>
            <div class="view-controls">
                <button class="control-btn" id="printBtn" aria-label="Print view">üñ®Ô∏è Print</button>
                <button class="control-btn" id="resetBtn" aria-label="Reset view">üîÑ Reset</button>
                <button class="control-btn" id="helpBtn" aria-label="Show keyboard shortcuts">‚å®Ô∏è Shortcuts</button>
            </div>
        </div>
        <div class="metrics-dashboard" role="region" aria-label="Performance metrics">
            <div class="metric-card">
                <div class="metric-value" aria-label="3 minutes average processing time">3min</div>
                <div class="metric-label">Avg Processing Time</div>
                <div class="metric-trend">‚Üì 95% reduction</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" aria-label="70 percent auto-approval rate">70%</div>
                <div class="metric-label">Auto-Approval Rate</div>
                <div class="metric-trend">‚Üë Zero-touch processing</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" aria-label="99.8 percent accuracy">99.8%</div>
                <div class="metric-label">Accuracy Rate</div>
                <div class="metric-trend">‚Üë AI + Human validation</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" aria-label="100 percent compliance">100%</div>
                <div class="metric-label">MGL Compliance</div>
                <div class="metric-trend">‚úì Audit-ready always</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" aria-label="24/7 availability">24/7</div>
                <div class="metric-label">Citizen Access</div>
                <div class="metric-trend">‚Üë No office hours limit</div>
            </div>
        </div>
        <div class="legend" role="region" aria-label="Workflow component legend">
            <div class="legend-item">
                <div class="legend-box" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);"></div>
                <span>Polimorphic Platform</span>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);"></div>
                <span>VAULT Processing</span>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);"></div>
                <span>AI Advisory</span>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);"></div>
                <span>Human Review</span>
            </div>
            <div class="legend-item">
                <div class="legend-box" style="background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);"></div>
                <span>Document Output</span>
            </div>
        </div>
        <!-- Timeline navigation converted to nav + ol for semantics -->
        <nav id="timelineNav" class="timeline-indicator" aria-label="Stage navigation">
            <ol style="list-style:none; margin:0; padding:0;">
                <li><button class="timeline-step" data-stage="1">1. Portal</button></li>
                <li><button class="timeline-step" data-stage="2">2. Form</button></li>
                <li><button class="timeline-step" data-stage="3">3. Intake</button></li>
                <li><button class="timeline-step" data-stage="4">4. Processing</button></li>
                <li><button class="timeline-step" data-stage="5">5. Generate</button></li>
                <li><button class="timeline-step" data-stage="6">6. Archive</button></li>
                <li><button class="timeline-step" data-stage="7">7. Publish</button></li>
            </ol>
        </nav>
        <main id="main-content" class="workflow">
            <!-- Stage 1: Citizen Portal -->
            <section class="flow-stage" id="stage-1" tabindex="-1" aria-labelledby="stage1-title">
                <div class="stage-header">
                    <div class="stage-number">1</div>
                    <div class="stage-title" id="stage1-title">Citizen Initiates Request</div>
                    <div class="stage-timing">‚è±Ô∏è 0:00 - 0:30</div>
                </div>
                <div class="node-container">
                    <div class="node node-polimorphic" tabindex="0" role="article" aria-label="Polimorphic Portal details">
                        <div class="node-title">
                            <span class="node-icon">üåê</span>
                            Polimorphic Portal
                        </div>
                        <div class="node-description">
                            Resident visits town website and selects service (dog license, business certificate, vital records, etc.)
                        </div>
                        <div class="node-detail">
                            ‚úì Mobile-responsive interface<br>
                            ‚úì WCAG 2.1 AA compliant<br>
                            ‚úì Multi-language support
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">üîß Technical Architecture:</div>
                            <div class="code-block">
                                Endpoint: https://api.polimorphic.com/v2/services<br>
                                Method: GET /services/list<br>
                                Auth: OAuth 2.0 + JWT
                            </div>
                            <div class="technical-label">üìä Data Flow:</div>
                            <div class="code-block">
                                1. User authentication via SSO<br>
                                2. Fetch available services from Polimorphic API<br>
                                3. Pre-populate user profile data<br>
                                4. Initialize session tracking
                            </div>
                            <div class="technical-label">‚ö° Performance:</div>
                            Page load: 1.2s average | Uptime: 99.97%
                        </div>
                    </div>
                </div>
            </section>
            <div class="connector">
                <div class="connector-arrow">‚Üì</div>
            </div>
            <!-- Stage 2: Smart Form -->
            <section class="flow-stage" id="stage-2" tabindex="-1" aria-labelledby="stage2-title">
                <div class="stage-header">
                    <div class="stage-number">2</div>
                    <div class="stage-title" id="stage2-title">Intelligent Form Completion</div>
                    <div class="stage-timing">‚è±Ô∏è 0:30 - 2:00</div>
                </div>
                <div class="node-container">
                    <div class="node node-polimorphic" tabindex="0" role="article" aria-label="Smart form engine details">
                        <div class="node-title">
                            <span class="node-icon">üìù</span>
                            Smart Form Engine
                        </div>
                        <div class="node-description">
                            Context-aware form adjusts based on license type, pre-fills known data from user profile, validates inputs in real-time
                        </div>
                        <div class="node-detail">
                            Integrated payment processing | Document upload | Real-time validation
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">üîß Form Configuration:</div>
                            <div class="code-block">
                                {<br>
                                &nbsp;&nbsp;"formType": "CLERK_DOGLIC",<br>
                                &nbsp;&nbsp;"validationRules": "MGL_c140_s137-174B",<br>
                                &nbsp;&nbsp;"requiredFields": ["owner", "dogName", "vaxCert"],<br>
                                &nbsp;&nbsp;"conditionalLogic": true<br>
                                }
                            </div>
                            <div class="technical-label">üîí Security:</div>
                            TLS 1.3 encryption | Field-level encryption for PII | CSRF protection
                        </div>
                    </div>
                    <div class="node node-ai" tabindex="0" role="article" aria-label="AI form assistant details">
                        <div class="node-title">
                            <span class="node-icon">ü§ñ</span>
                            AI Form Assistant
                        </div>
                        <div class="node-description">
                            Provides help text, answers questions, detects common errors before submission
                        </div>
                        <div class="node-detail">
                            Reduces incomplete applications by 75%
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">üß† AI Model:</div>
                            <div class="code-block">
                                Model: GPT-4-based municipal assistant<br>
                                Training: 50K+ clerk transactions<br>
                                Accuracy: 94.3% intent recognition
                            </div>
                            <div class="technical-label">‚öôÔ∏è Validation Logic:</div>
                            <div class="code-block">
                                ‚Ä¢ Address validation (USPS API)<br>
                                ‚Ä¢ Date format correction<br>
                                ‚Ä¢ File type/size validation<br>
                                ‚Ä¢ Duplicate detection (fuzzy match)
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <div class="connector">
                <div class="connector-arrow">‚Üì</div>
            </div>
            <!-- Stage 3: VAULT Intake -->
            <section class="flow-stage" id="stage-3" tabindex="-1" aria-labelledby="stage3-title">
                <div class="stage-header">
                    <div class="stage-number">3</div>
                    <div class="stage-title" id="stage3-title">VAULT‚Ñ¢ Intelligent Intake</div>
                    <div class="stage-timing">‚è±Ô∏è 2:00 - 2:15</div>
                </div>
                <div class="node-container">
                    <div class="node node-vault" tabindex="0" role="article" aria-label="Classification engine details">
                        <div class="node-title">
                            <span class="node-icon">üéØ</span>
                            Classification Engine
                        </div>
                        <div class="node-description">
                            Automatically categorizes request type, applies correct metadata schema, assigns retention code
                        </div>
                        <div class="node-detail">
                            Reference ID: CLERK_DOGLIC_2025-11-07_001_v1
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">üè∑Ô∏è Metadata Schema:</div>
                            <div class="code-block">
                                {<br>
                                &nbsp;&nbsp;"refID": "CLERK_DOGLIC_2025-11-07_001_v1",<br>
                                &nbsp;&nbsp;"category": "Licensing",<br>
                                &nbsp;&nbsp;"subcategory": "Dog",<br>
                                &nbsp;&nbsp;"retentionCode": "GS-02-235",<br>
                                &nbsp;&nbsp;"retention": "Permanent",<br>
                                &nbsp;&nbsp;"publicRecord": true<br>
                                }
                            </div>
                            <div class="technical-label">üìÅ File Structure:</div>
                            <div class="code-block">
                                /TownClerk/2025/DogLicenses/<br>
                                &nbsp;&nbsp;CLERK_DOGLIC_2025-11-07_001_v1.pdf
                            </div>
                        </div>
                    </div>
                    <div class="node node-vault" tabindex="0" role="article" aria-label="Compliance check details">
                        <div class="node-title">
                            <span class="node-icon">‚úÖ</span>
                            Compliance Check
                        </div>
                        <div class="node-description">
                            Verifies all required fields, attachments, and fees against MGL requirements
                        </div>
                        <div class="node-detail">
                            MGL c.140 ¬ß137-174B validation
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">‚öñÔ∏è Legal Requirements:</div>
                            <div class="code-block">
                                ‚Ä¢ Current rabies vaccination (MGL c.140 ¬ß145B)<br>
                                ‚Ä¢ Owner address verification<br>
                                ‚Ä¢ Fee payment ($20 spayed/neutered, $30 intact)<br>
                                ‚Ä¢ Prior license check (renewals)
                            </div>
                            <div class="technical-label">üîç Validation Results:</div>
                            <div class="code-block">
                                Status: PASS | Completeness: 100%<br>
                                Required docs: 3/3 present<br>
                                Payment: Verified ($20.00 via Stripe)
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <div class="connector">
                <div class="connector-arrow">‚Üì</div>
            </div>
            <!-- Relief Point -->
            <div class="relief-section">
                <div class="relief-title">
                    <span>üéØ</span> KEY INTEGRATION POINT
                </div>
                <div class="relief-content">
                    <strong>Polimorphic handles the citizen experience</strong> while <strong>VAULT handles the compliance</strong>. The resident never sees the complexity‚Äî they just get a smooth, fast process.
                    <div class="relief-highlight">
                        <strong>At this stage:</strong> Application is complete, validated, and properly classified. The system has automatically routed it to the correct workflow and determined whether human review is needed. All MGL requirements have been verified, and the application is ready for processing in under 2 minutes.
                    </div>
                </div>
            </div>
            <!-- Decision Point -->
            <div class="decision-point">
                <div class="decision-title">
                    <span>üîÄ</span> AI-Powered Routing Decision
                </div>
                <div>Based on machine learning analysis and business rules, the system intelligently routes the application:</div>
                <div class="decision-options" role="group" aria-label="Routing decision">
                    <div class="decision-option" role="button" aria-pressed="false" tabindex="0" data-percentage="70%">üöÄ Auto-Approve (Standard Cases)</div>
                    <div class="decision-option" role="button" aria-pressed="false" tabindex="0" data-percentage="25%">üë§ Clerk Review (Flagged Issues)</div>
                    <div class="decision-option" role="button" aria-pressed="false" tabindex="0" data-percentage="5%">‚ö†Ô∏è Special Handling (Complex/Legal)</div>
                </div>
            </div>
            <div class="connector">
                <div class="connector-arrow">‚Üì</div>
            </div>
            <!-- Stage 4: Processing -->
            <section class="flow-stage" id="stage-4" tabindex="-1" aria-labelledby="stage4-title">
                <div class="stage-header">
                    <div class="stage-number">4</div>
                    <div class="stage-title" id="stage4-title">Intelligent Processing</div>
                    <div class="stage-timing">‚è±Ô∏è 2:15 - 2:45</div>
                </div>
                <div class="node-container">
                    <div class="node node-ai" tabindex="0" role="article" aria-label="AI pre-screening details">
                        <div class="node-title">
                            <span class="node-icon">üîç</span>
                            AI Pre-Screening
                        </div>
                        <div class="node-description">
                            Checks for duplicates, validates supporting documents, cross-references against existing records
                        </div>
                        <div class="node-detail">
                            Flags issues for clerk attention when needed
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">ü§ñ AI Screening Process:</div>
                            <div class="code-block">
                                1. Duplicate detection (Levenshtein distance &lt; 0.15)<br>
                                2. Document authenticity (watermark detection)<br>
                                3. Historical compliance check (prior violations)<br>
                                4. Cross-reference vaccinations database<br>
                                5. Flag unusual patterns for review
                            </div>
                            <div class="technical-label">üìä Confidence Score:</div>
                            <div class="code-block">
                                Overall: 96.7% (AUTO-APPROVE threshold: 95%)<br>
                                ‚Ä¢ Identity: 99.2%<br>
                                ‚Ä¢ Document validity: 98.1%<br>
                                ‚Ä¢ Duplicate check: 94.3%<br>
                                ‚Ä¢ Compliance: 100%
                            </div>
                        </div>
                    </div>
                    <div class="node node-human" tabindex="0" role="article" aria-label="Clerk review queue details">
                        <div class="node-title">
                            <span class="node-icon">üë•</span>
                            Clerk Review Queue
                        </div>
                        <div class="node-description">
                            Only flagged applications appear here with AI summary highlighting issues or questions
                        </div>
                        <div class="node-detail">
                            Clerk makes final decision: Approve | Deny | Request Info
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">üìã Review Dashboard:</div>
                            <div class="code-block">
                                Queue: 3 items (avg wait: 14 minutes)<br>
                                Priority scoring: Risk-based algorithm<br>
                                SLA: 2 hours for standard, 30 min urgent
                            </div>
                            <div class="technical-label">üéØ AI Summary for Clerk:</div>
                            <div class="code-block">
                                "Flagged for review: Vaccination cert expiry<br>
                                date is within 30 days. Recommend approval<br>
                                with 30-day renewal notice. No prior issues."
                            </div>
                            <div class="technical-label">‚ö° Clerk Actions:</div>
                            <div class="code-block">
                                ‚Ä¢ One-click approve with AI recommendation<br>
                                ‚Ä¢ Conditional approval (add requirements)<br>
                                ‚Ä¢ Deny with templated explanation<br>
                                ‚Ä¢ Request additional information
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <div class="connector">
                <div class="connector-arrow">‚Üì</div>
            </div>
            <!-- Stage 5: Document Generation -->
            <section class="flow-stage" id="stage-5" tabindex="-1" aria-labelledby="stage5-title">
                <div class="stage-header">
                    <div class="stage-number">5</div>
                    <div class="stage-title" id="stage5-title">Document Generation &amp; Certification</div>
                    <div class="stage-timing">‚è±Ô∏è 2:45 - 2:55</div>
                </div>
                <div class="node-container">
                    <div class="node node-output" tabindex="0" role="article" aria-label="Certificate generation details">
                        <div class="node-title">
                            <span class="node-icon">üìÑ</span>
                            Generate Certificate
                        </div>
                        <div class="node-description">
                            Creates official document using approved template, applies digital seal, inserts all required fields
                        </div>
                        <div class="node-detail">
                            Format: PDF/A with embedded metadata and watermark
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">üìù Document Generation:</div>
                            <div class="code-block">
                                Template: approved_dog_license_2025.docx<br>
                                Engine: python-docx + PDF converter<br>
                                Seal: SVG ‚Üí embedded at 300dpi<br>
                                QR Code: Generated with verification URL
                            </div>
                            <div class="technical-label">üîê Digital Signature:</div>
                            <div class="code-block">
                                Algorithm: RSA-4096 + SHA-256<br>
                                Timestamp: RFC 3161 compliant<br>
                                Certificate Authority: Town of X CA<br>
                                Validation: blockchain hash recorded
                            </div>
                            <div class="technical-label">üìã Generated Fields:</div>
                            <div class="code-block">
                                ‚Ä¢ License #: 2025-DOG-001<br>
                                ‚Ä¢ Issue Date: 2025-11-07<br>
                                ‚Ä¢ Expiry: 2026-11-07<br>
                                ‚Ä¢ Tag #: TD-2025-001<br>
                                ‚Ä¢ QR: https://town.ma.us/verify/TD2025001
                            </div>
                        </div>
                    </div>
                    <div class="node node-vault" tabindex="0" role="article" aria-label="Version control details">
                        <div class="node-title">
                            <span class="node-icon">üè∑Ô∏è</span>
                            Version Control
                        </div>
                        <div class="node-description">
                            Applies naming convention, creates audit trail, links to related documents
                        </div>
                        <div class="node-detail">
                            Every action logged with timestamp and user
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">üìÅ Version Control System:</div>
                            <div class="code-block">
                                File: CLERK_DOGLIC_2025-11-07_001_v1.pdf<br>
                                SHA-256: a3f9c8b2e1d0f7c4b8a5e9d2f6c3b7a1<br>
                                Size: 247 KB<br>
                                Pages: 1<br>
                                Created: 2025-11-07T14:55:23Z
                            </div>
                            <div class="technical-label">üîó Audit Trail:</div>
                            <div class="code-block">
                                2025-11-07 14:53:12 - Application received<br>
                                2025-11-07 14:53:45 - AI validation complete<br>
                                2025-11-07 14:54:02 - Auto-approved (95.3%)<br>
                                2025-11-07 14:55:23 - Certificate generated<br>
                                2025-11-07 14:55:24 - Digital seal applied<br>
                                User: system@vault.townclerk.ma
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <div class="connector">
                <div class="connector-arrow">‚Üì</div>
            </div>
            <!-- Stage 6: Storage & Delivery -->
            <section class="flow-stage" id="stage-6" tabindex="-1" aria-labelledby="stage6-title">
                <div class="stage-header">
                    <div class="stage-number">6</div>
                    <div class="stage-title" id="stage6-title">Archive &amp; Citizen Notification</div>
                    <div class="stage-timing">‚è±Ô∏è 2:55 - 3:00</div>
                </div>
                <div class="node-container">
                    <div class="node node-archive" tabindex="0" role="article" aria-label="Archive in VAULT details">
                        <div class="node-title">
                            <span class="node-icon">üóÑÔ∏è</span>
                            Archive in VAULT
                        </div>
                        <div class="node-description">
                            Stores in structured directory: /TownClerk/2025/DogLicenses/ with full retention metadata
                        </div>
                        <div class="node-detail">
                            Retention: Permanent | Searchable | Audit Ready
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">üíæ Storage Architecture:</div>
                            <div class="code-block">
                                Primary: AWS S3 (us-east-1)<br>
                                Backup: Azure Blob (redundant)<br>
                                Encryption: AES-256 at rest<br>
                                Replication: 3x geographic<br>
                                Backup frequency: Real-time + daily
                            </div>
                            <div class="technical-label">üîç Search Indexing:</div>
                            <div class="code-block">
                                Engine: Elasticsearch 8.x<br>
                                Indexed fields: 23 searchable attributes<br>
                                Full-text OCR: Available<br>
                                Search latency: 12ms average
                            </div>
                            <div class="technical-label">üìä Retention Metadata:</div>
                            <div class="code-block">
                                {<br>
                                &nbsp;&nbsp;"retentionSchedule": "GS-02-235",<br>
                                &nbsp;&nbsp;"retentionPeriod": "Permanent",<br>
                                &nbsp;&nbsp;"reviewDate": null,<br>
                                &nbsp;&nbsp;"disposalAction": "None",<br>
                                &nbsp;&nbsp;"legalHold": false<br>
                                }
                            </div>
                        </div>
                    </div>
                    <div class="node node-polimorphic" tabindex="0" role="article" aria-label="Citizen notification details">
                        <div class="node-title">
                            <span class="node-icon">üìß</span>
                            Notify Citizen
                        </div>
                        <div class="node-description">
                            Sends email/SMS with download link, adds to citizen portal dashboard, schedules renewal reminder
                        </div>
                        <div class="node-detail">
                            Average processing time: 3 minutes vs. 7+ days traditional
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">üì¨ Multi-Channel Notification:</div>
                            <div class="code-block">
                                Email: SendGrid API (delivered in 2.3s)<br>
                                SMS: Twilio API (optional, delivered in 1.1s)<br>
                                Portal: Dashboard updated real-time<br>
                                Push: Mobile app notification (if installed)
                            </div>
                            <div class="technical-label">üìÖ Automated Reminders:</div>
                            <div class="code-block">
                                60 days before expiry: First reminder<br>
                                30 days before expiry: Second reminder<br>
                                7 days before expiry: Final reminder<br>
                                On expiry: Grace period notification<br>
                                30 days after expiry: Late fee notice
                            </div>
                            <div class="technical-label">üîó Download Access:</div>
                            <div class="code-block">
                                Secure URL: https://portal.town.ma.us/docs/<br>
                                &nbsp;&nbsp;secure/TD2025001?token=a3f9c8b2<br>
                                Expiry: 90 days (renewable)<br>
                                Access log: IP + timestamp recorded
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <div class="connector">
                <div class="connector-arrow">‚Üì</div>
            </div>
            <!-- Stage 7: Public Access & Reporting -->
            <section class="flow-stage" id="stage-7" tabindex="-1" aria-labelledby="stage7-title">
                <div class="stage-header">
                    <div class="stage-number">7</div>
                    <div class="stage-title" id="stage7-title">Transparency &amp; Reporting</div>
                    <div class="stage-timing">‚è±Ô∏è Ongoing / Automated</div>
                </div>
                <div class="node-container">
                    <div class="node node-polimorphic" tabindex="0" role="article" aria-label="Public records portal details">
                        <div class="node-title">
                            <span class="node-icon">üåç</span>
                            Public Records Portal
                        </div>
                        <div class="node-description">
                            Publishes appropriate records to searchable public database (respecting privacy laws)
                        </div>
                        <div class="node-detail">
                            FOIA-ready | Searchable | Accessible
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">üîì Public Access System:</div>
                            <div class="code-block">
                                Portal: https://records.town.ma.us<br>
                                Search: Advanced filtering + facets<br>
                                Export: PDF, CSV, JSON formats<br>
                                Rate limiting: 100 requests/hour/IP
                            </div>
                            <div class="technical-label">üîí Privacy Protection:</div>
                            <div class="code-block">
                                ‚Ä¢ PII redaction (addresses, phone)<br>
                                ‚Ä¢ Social Security # removed<br>
                                ‚Ä¢ Payment info excluded<br>
                                ‚Ä¢ MGL c.4 ¬ß7(26) exemptions applied<br>
                                ‚Ä¢ Automated redaction with manual review
                            </div>
                            <div class="technical-label">üìä Analytics:</div>
                            <div class="code-block">
                                Public requests: 1,247 this month<br>
                                Most accessed: Business certificates<br>
                                Avg response time: 0.8 seconds
                            </div>
                        </div>
                    </div>
                    <div class="node node-vault" tabindex="0" role="article" aria-label="State reporting details">
                        <div class="node-title">
                            <span class="node-icon">üìä</span>
                            State Reporting
                        </div>
                        <div class="node-description">
                            Automatically generates required state reports, compiles statistics, maintains audit logs
                        </div>
                        <div class="node-detail">
                            Monthly reports generated automatically
                        </div>
                        <div class="node-technical">
                            <div class="technical-label">üìà Automated Reporting:</div>
                            <div class="code-block">
                                Frequency: Monthly to MA Secretary of State<br>
                                Format: MUNIS-compliant XML + PDF<br>
                                Transmission: Secure FTP + API<br>
                                Verification: Automated acknowledgment
                            </div>
                            <div class="technical-label">üìã Report Contents:</div>
                            <div class="code-block">
                                ‚Ä¢ Dog licenses issued: Count + revenue<br>
                                ‚Ä¢ Business certificates: New + renewals<br>
                                ‚Ä¢ Vital records: Births, deaths, marriages<br>
                                ‚Ä¢ Meeting minutes: Compliance tracking<br>
                                ‚Ä¢ FOIA requests: Volume + resolution time
                            </div>
                            <div class="technical-label">üîç Audit Trail:</div>
                            <div class="code-block">
                                Retention: 7 years minimum<br>
                                Immutable logs: Blockchain-verified<br>
                                Access tracking: Who, what, when<br>
                                Compliance: SOC 2 Type II certified
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- Final Relief -->
            <div class="relief-section" style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); border-color: #10b981;">
                <div class="relief-title" style="color: #065f46;">
                    <span>‚ú®</span> THE MEASURABLE RESULTS
                </div>
                <div class="relief-content" style="color: #047857;">
                    <strong>What used to take 7+ days and multiple office visits now happens in 3 minutes.</strong>
                    <div class="relief-highlight">
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin: 10px 0;">‚úÖ <strong>Resident:</strong> Submits online anytime, gets instant confirmation, downloads certificate in 3 minutes</li>
                            <li style="margin: 10px 0;">‚úÖ <strong>Town Clerk:</strong> Reviews 25% of cases (vs 100%), maintains oversight, reduces workload by 70%, zero paper filing</li>
                            <li style="margin: 10px 0;">‚úÖ <strong>Town:</strong> Complete audit trail, 100% MGL compliance, $45K/year savings on staff time, 99.8% accuracy</li>
                            <li style="margin: 10px 0;">‚úÖ <strong>State:</strong> Automatic reporting, real-time data access, regulatory compliance, reduced inquiry volume</li>
                        </ul>
                        <div style="margin-top: 20px; padding: 15px; background: #ecfdf5; border-radius: 8px; border-left: 4px solid #10b981;">
                            <strong>ROI:</strong> First-year cost savings of $45,000 in staff time + $12,000 in paper/storage costs. System pays for itself in 8 months. Resident satisfaction increases from 62% to 94%.
                        </div>
                    </div>
                </div>
            </div>
            <!-- Print-only summary -->
            <div class="print-mode">
                <h2>System Overview (Print Summary)</h2>
                <p><strong>Polimorphic + VAULTCLERK‚Ñ¢</strong> represents a complete digital transformation of municipal clerk operations, reducing processing times from days to minutes while maintaining 100% compliance with Massachusetts General Laws.</p>
                <h3>Key Performance Indicators:</h3>
                <ul>
                    <li>Processing Time: 3 minutes (95% reduction)</li>
                    <li>Auto-Approval Rate: 70% (zero-touch processing)</li>
                    <li>Accuracy: 99.8% (AI + human validation)</li>
                    <li>Compliance: 100% (audit-ready always)</li>
                    <li>Availability: 24/7 (no office hours limitation)</li>
                </ul>
                <h3>Technical Architecture:</h3>
                <ul>
                    <li>Frontend: Polimorphic citizen portal (mobile-responsive, WCAG 2.1 AA)</li>
                    <li>Processing: VAULT compliance engine (MGL validation, metadata management)</li>
                    <li>AI Layer: Machine learning screening (94.3% accuracy, duplicate detection)</li>
                    <li>Storage: Enterprise-grade cloud storage (AES-256, geographic redundancy)</li>
                    <li>Integration: RESTful APIs, OAuth 2.0, real-time synchronization</li>
                </ul>
            </div>
        </main>
        <footer class="footer">
            <div class="footer-logo">PublicLogic‚Ñ¢</div>
            <div class="footer-tagline">Smart Systems. Stronger Communities.</div>
            <div style="margin-top: 15px; opacity: 0.7; font-size: 0.9em;">
                Polimorphic Platform Integration | VAULTCLERK‚Ñ¢ Compliance Framework<br>
                Patent-Pending Technology | SOC 2 Type II Certified
            </div>
        </footer>
    </div>
    <!-- Live region for announcing state changes -->
    <div id="live" class="sr-only" aria-live="polite"></div>
    <script>
        // Technical mode toggle
        const techModeToggle = document.getElementById('techModeToggle');
        const techModeText = document.getElementById('techModeText');
        let technicalMode = false;
        function toggleTechnicalMode() {
            technicalMode = !technicalMode;
            const technicalSections = document.querySelectorAll('.node-technical');
            technicalSections.forEach(section => {
                if (technicalMode) {
                    section.classList.add('visible');
                } else {
                    section.classList.remove('visible');
                }
            });
            techModeToggle.classList.toggle('active');
            // Toggle aria-pressed state for better accessibility
            techModeToggle.setAttribute('aria-pressed', technicalMode);
            techModeText.textContent = technicalMode ? 'üîß Technical Mode' : 'üìä Simple Mode';
            // Announce mode change
            const live = document.getElementById('live');
            live.textContent = technicalMode ? 'Technical mode on' : 'Technical mode off';
        }
        techModeToggle.addEventListener('click', toggleTechnicalMode);
        // Node click handlers with enhanced feedback
        document.querySelectorAll('.node').forEach(node => {
            node.addEventListener('click', function() {
                this.style.transform = 'scale(1.05)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 300);
            });
            // Keyboard support using keydown
            node.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    this.click();
                }
            });
        });
        // Decision option interaction
        document.querySelectorAll('.decision-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.decision-option').forEach(opt => {
                    opt.style.background = 'white';
                    opt.style.color = '#92400e';
                    opt.setAttribute('aria-pressed', 'false');
                });
                this.style.background = '#f59e0b';
                this.style.color = 'white';
                this.setAttribute('aria-pressed', 'true');
                // Announce selection
                const live = document.getElementById('live');
                live.textContent = `${this.textContent.trim()} selected`;
            });
            option.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    this.click();
                }
            });
        });
        // Timeline navigation
        const timelineNav = document.getElementById('timelineNav');
        const timelineSteps = document.querySelectorAll('.timeline-step');
        // Throttle scroll handler
        let ticking = false;
        window.addEventListener('scroll', () => {
            if (!ticking) {
                window.requestAnimationFrame(() => {
                    // Show/hide timeline based on scroll position
                    if (window.scrollY > 300) {
                        timelineNav.classList.add('visible');
                    } else {
                        timelineNav.classList.remove('visible');
                    }
                    // Update active stage based on viewport
                    const stages = document.querySelectorAll('.flow-stage');
                    let currentStage = 1;
                    stages.forEach((stage, index) => {
                        const rect = stage.getBoundingClientRect();
                        if (rect.top <= window.innerHeight / 2 && rect.bottom >= window.innerHeight / 2) {
                            currentStage = index + 1;
                        }
                    });
                    timelineSteps.forEach(step => {
                        if (parseInt(step.dataset.stage) === currentStage) {
                            step.classList.add('active');
                        } else {
                            step.classList.remove('active');
                        }
                    });
                    ticking = false;
                });
                ticking = true;
            }
        }, { passive: true });
        timelineSteps.forEach(step => {
            step.addEventListener('click', function() {
                const stageNum = this.dataset.stage;
                const targetStage = document.getElementById(`stage-${stageNum}`);
                targetStage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                // Move focus for screen reader users
                targetStage.focus();
            });
            step.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    this.click();
                }
            });
        });
        // Control buttons
        document.getElementById('printBtn').addEventListener('click', () => {
            window.print();
        });
        document.getElementById('resetBtn').addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
            if (technicalMode) {
                toggleTechnicalMode();
            }
        });
        const keyboardHint = document.getElementById('keyboardHint');
        document.getElementById('helpBtn').addEventListener('click', () => {
            keyboardHint.classList.toggle('visible');
            setTimeout(() => {
                keyboardHint.classList.remove('visible');
            }, 5000);
        });
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // T for technical mode toggle
            if ((e.key === 't' || e.key === 'T') && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA') {
                toggleTechnicalMode();
            }
            // P for print (avoid Ctrl+P conflict)
            if ((e.key === 'p' || e.key === 'P') && !(e.ctrlKey || e.metaKey) && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA') {
                e.preventDefault();
                window.print();
            }
            // Arrow keys for navigation
            if (e.key === 'ArrowDown' && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA') {
                e.preventDefault();
                const stages = Array.from(document.querySelectorAll('.flow-stage'));
                const currentIndex = stages.findIndex(stage => {
                    const rect = stage.getBoundingClientRect();
                    return rect.top <= window.innerHeight / 2 && rect.bottom >= window.innerHeight / 2;
                });
                if (currentIndex < stages.length - 1) {
                    stages[currentIndex + 1].scrollIntoView({ behavior: 'smooth', block: 'center' });
                    stages[currentIndex + 1].focus();
                }
            }
            if (e.key === 'ArrowUp' && document.activeElement.tagName !== 'INPUT' && document.activeElement.tagName !== 'TEXTAREA') {
                e.preventDefault();
                const stages = Array.from(document.querySelectorAll('.flow-stage'));
                const currentIndex = stages.findIndex(stage => {
                    const rect = stage.getBoundingClientRect();
                    return rect.top <= window.innerHeight / 2 && rect.bottom >= window.innerHeight / 2;
                });
                if (currentIndex > 0) {
                    stages[currentIndex - 1].scrollIntoView({ behavior: 'smooth', block: 'center' });
                    stages[currentIndex - 1].focus();
                }
            }
        });
        // Show keyboard hint on first load
        window.addEventListener('load', () => {
            setTimeout(() => {
                keyboardHint.classList.add('visible');
                setTimeout(() => {
                    keyboardHint.classList.remove('visible');
                }, 5000);
            }, 2000);
        });
        // Smooth scroll for skip link
        document.querySelector('.skip-link').addEventListener('click', (e) => {
            e.preventDefault();
            const mainContent = document.getElementById('main-content');
            mainContent.scrollIntoView({ behavior: 'smooth' });
            mainContent.focus();
        });
    </script>
</body>
</html>