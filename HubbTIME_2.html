<!doctype html>

<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HubbTIME · Town of Hubbardston</title>
  <style>
:root {
  --forest-dark: #1a3d2e; --forest: #2d5a47; --sage: #4a7560; --sage-light: #6b9080;
  --meadow: #86a895; --cream: #f4f1e8; --ink: #2c2416; --bg: var(--cream);
  --panel: #fefcf8; --card: #ffffff; --muted: #6b6b47; --border: #d4cfc4;
  --shadow: rgba(45, 90, 71, 0.08); --accent: var(--forest); --accent-light: var(--sage);
  --success: #22c55e; --warning: #f59e0b; --error: #ef4444; --info: #3b82f6;
  --space-xs: 0.25rem; --space-sm: 0.5rem; --space-md: 1rem; --space-lg: 1.5rem;
  --space-xl: 2rem; --space-2xl: 3rem; --radius: 8px; --radius-lg: 12px; --transition: 0.2s ease;
}
[data-theme="dark"] {
  --bg: #0f1714; --panel: #111d18; --card: #13211b; --ink: #e7f2ec;
  --muted: #7aa892; --border: #1f2c27; --shadow: rgba(0, 0, 0, 0.25);
}
*, *::before, *::after { box-sizing: border-box; }
html, body {
  margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: var(--bg); color: var(--ink); line-height: 1.6; min-height: 100vh; font-size: 16px;
}
h1, h2, h3 { margin: 0 0 var(--space-md) 0; font-weight: 600; line-height: 1.3; color: var(--accent); }
h1 { font-size: 2.2rem; } h2 { font-size: 1.8rem; } h3 { font-size: 1.4rem; }
p { margin: 0 0 var(--space-md) 0; }
.container { max-width: 1200px; margin: 0 auto; padding: var(--space-lg); }
.site-header {
  background: linear-gradient(135deg, var(--forest-dark) 0%, var(--forest) 100%);
  color: var(--cream); padding: var(--space-lg); box-shadow: 0 2px 8px var(--shadow);
  display: flex; align-items: center; gap: var(--space-lg); flex-wrap: wrap;
}
.brand { display: flex; align-items: center; gap: var(--space-md); }
.seal {
  width: 3rem; height: 3rem; background: var(--sage-light); color: var(--forest-dark);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  font-weight: bold; font-size: 1.2rem; border: 2px solid var(--cream);
}
.site-title { font-size: 1.8rem; font-weight: 700; color: var(--cream); margin: 0; }
.tagline { color: rgba(255, 255, 255, 0.9); font-size: 0.9rem; margin: 0; font-style: italic; }
.theme-toggle { margin-left: auto; }
.page-header { text-align: center; margin-bottom: var(--space-2xl); padding: var(--space-2xl) 0; }
.page-header h1 { font-size: 2.5rem; margin-bottom: var(--space-md); }
.page-header p { font-size: 1.1rem; color: var(--muted); }
.card {
  background: var(--card); border: 1px solid var(--border); border-radius: var(--radius-lg);
  margin-bottom: var(--space-xl); box-shadow: 0 2px 8px var(--shadow); overflow: hidden;
}
.card-header { padding: var(--space-lg); border-bottom: 1px solid var(--border); background: var(--panel); }
.card-title { margin: 0; color: var(--accent); font-size: 1.3rem; }
.card > :not(.card-header) { padding: var(--space-lg); }
.form-group { margin-bottom: var(--space-lg); }
.label { display: block; font-weight: 600; margin-bottom: var(--space-sm); color: var(--ink); }
.input, select, textarea {
  width: 100%; padding: var(--space-sm) var(--space-md); border: 1px solid var(--border);
  border-radius: var(--radius); background: var(--panel); color: var(--ink);
  font-size: 1rem; transition: var(--transition); font-family: inherit;
}
.input:focus, select:focus { outline: none; border-color: var(--accent); box-shadow: 0 0 0 3px rgba(45, 90, 71, 0.1); }
.btn {
  display: inline-flex; align-items: center; gap: var(--space-sm); padding: var(--space-sm) var(--space-md);
  border-radius: var(--radius); border: none; cursor: pointer; font-weight: 500; font-size: 0.95rem;
  transition: var(--transition); background: var(--accent); color: white; font-family: inherit;
}
.btn:hover { transform: translateY(-1px); box-shadow: 0 3px 8px var(--shadow); }
.btn.primary { background: var(--accent); }
.btn.secondary { background: var(--sage-light); color: var(--forest-dark); }
.btn.danger { background: var(--error); }
.btn.ghost { background: transparent; border: 1px solid var(--border); color: var(--ink); }
.btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
.quick-actions {
  display: flex; gap: var(--space-sm); flex-wrap: wrap; margin-bottom: var(--space-lg);
  padding: var(--space-md); background: var(--panel); border-radius: var(--radius);
}
.table-container { overflow-x: auto; border: 1px solid var(--border); border-radius: var(--radius); background: var(--card); }
table { width: 100%; border-collapse: collapse; }
th, td { padding: var(--space-sm); text-align: left; border-bottom: 1px solid var(--border); }
th { background: var(--panel); font-weight: 600; }
tbody tr:hover { background: rgba(45, 90, 71, 0.05); }
table input, table select { width: 100%; min-width: 100px; margin: 0; padding: 4px 8px; font-size: 0.9rem; }
.row-btn {
  padding: 2px 6px; font-size: 12px; border: 1px solid var(--border); background: var(--panel);
  border-radius: 4px; cursor: pointer; transition: var(--transition);
}
.row-btn:hover { background: var(--accent); color: white; }
.employee-info {
  background: linear-gradient(135deg, var(--sage-light) 0%, var(--meadow) 100%);
  color: var(--forest-dark); padding: var(--space-lg); border-radius: var(--radius-lg); margin-top: var(--space-md);
}
[data-theme="dark"] .employee-info { background: linear-gradient(135deg, var(--forest) 0%, var(--sage) 100%); color: var(--cream); }
.totals-panel {
  background: linear-gradient(135deg, var(--forest) 0%, var(--sage) 100%);
  color: var(--cream); padding: var(--space-xl); border-radius: var(--radius-lg); margin: var(--space-lg) 0;
}
.totals-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: var(--space-md); }
.total-item { text-align: center; padding: var(--space-md); background: rgba(255, 255, 255, 0.1); border-radius: var(--radius); }
.total-label { font-size: 0.85rem; opacity: 0.9; margin-bottom: var(--space-xs); }
.total-value { font-size: 1.2rem; font-weight: 700; }
.alert { padding: var(--space-md); border-radius: var(--radius); margin-bottom: var(--space-md); border-left: 4px solid; }
.alert.info { background: rgba(59, 130, 246, 0.1); border-color: var(--info); color: var(--info); }
.alert.success { background: rgba(34, 197, 94, 0.1); border-color: var(--success); color: var(--success); }
.alert.error { background: rgba(239, 68, 68, 0.1); border-color: var(--error); color: var(--error); }
.alert.warning { background: rgba(245, 158, 11, 0.1); border-color: var(--warning); color: var(--warning); }
.text-center { text-align: center; }
.mt-md { margin-top: var(--space-md); }
.site-footer { background: var(--panel); border-top: 1px solid var(--border); margin-top: var(--space-2xl); padding: var(--space-lg); text-align: center; color: var(--muted); }
.modal {
  display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6);
  z-index: 1000; align-items: center; justify-content: center;
}
.modal.active { display: flex; }
.modal-content {
  background: var(--card); padding: var(--space-xl); border-radius: var(--radius-lg);
  max-width: 400px; width: 90%; box-shadow: 0 4px 20px var(--shadow);
}
.modal-buttons { display: flex; gap: var(--space-md); margin-top: var(--space-lg); }
@media (max-width: 768px) {
  .container { padding: var(--space-md); }
  .site-header { padding: var(--space-md); flex-direction: column; }
  .quick-actions { flex-direction: column; }
}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="brand">
      <div class="seal">H</div>
      <div>
        <h1 class="site-title">HubbTIME</h1>
        <p class="tagline">Town of Hubbardston · Municipal Timesheet System</p>
      </div>
    </div>
    <div class="theme-toggle">
      <button id="themeToggle" class="btn ghost">Light</button>
    </div>
  </header>

  <main class="container">
    <header class="page-header">
      <h1>Enhanced Biweekly Timesheet</h1>
      <p>Smart timesheet system with automated calculations</p>
    </header>

```
<form id="timesheetForm">
  <div id="systemMsg" class="alert info" style="display:none;"></div>

  <section class="card">
    <div class="card-header"><h2 class="card-title">Employee Information</h2></div>
    <div class="form-group">
      <label class="label" for="employeeSearch">Employee Name</label>
      <input id="employeeSearch" list="employeeList" class="input" placeholder="Start typing name..." autocomplete="off">
      <datalist id="employeeList"></datalist>
    </div>
    <div class="employee-info" id="employeeDetails" style="display:none;">
      <div class="totals-grid">
        <div class="total-item"><div class="total-label">Employee #</div><div class="total-value" id="empId">—</div></div>
        <div class="total-item"><div class="total-label">Name</div><div class="total-value" id="empName">—</div></div>
        <div class="total-item"><div class="total-label">Rate</div><div class="total-value" id="rate">—</div></div>
      </div>
    </div>
  </section>

  <section class="card">
    <div class="card-header"><h2 class="card-title">Time Entries</h2></div>
    <div class="quick-actions">
      <button type="button" class="btn primary" id="addRowBtn">Add Row</button>
      <button type="button" class="btn secondary" id="townHallBtn">Town Hall Hours</button>
      <button type="button" class="btn secondary" id="sickBtn">Sick Day (8h)</button>
      <button type="button" class="btn secondary" id="vacationBtn">Vacation Day (8h)</button>
      <button type="button" class="btn secondary" id="personalBtn">Personal Time</button>
      <button type="button" class="btn secondary" id="stipendBtn">Stipend</button>
      <button type="button" class="btn danger" id="clearAllBtn">Clear All</button>
    </div>
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Start</th>
            <th>End</th>
            <th>Hours</th>
            <th>Type</th>
            <th>Description</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="timeBody"></tbody>
      </table>
    </div>
  </section>

  <section class="card">
    <div class="card-header"><h2 class="card-title">Summary</h2></div>
    <div class="totals-panel">
      <div style="display:flex;justify-content:space-between;margin-bottom:var(--space-md);">
        <div><div class="total-label">Total Hours</div><div id="totalHours" class="total-value">0.00</div></div>
        <div><div class="total-label">Estimated Pay</div><div id="grossPay" class="total-value">$0.00</div></div>
      </div>
    </div>
    <div class="totals-grid">
      <div class="total-item"><div class="total-label">Regular</div><div class="total-value" id="sumRegular">0.00</div></div>
      <div class="total-item"><div class="total-label">Sick</div><div class="total-value" id="sumSick">0.00</div></div>
      <div class="total-item"><div class="total-label">Vacation</div><div class="total-value" id="sumVacation">0.00</div></div>
      <div class="total-item"><div class="total-label">Personal</div><div class="total-value" id="sumPersonal">0.00</div></div>
      <div class="total-item"><div class="total-label">Stipend</div><div class="total-value" id="sumStipend">0.00</div></div>
    </div>
  </section>

  <section class="card text-center">
    <button type="submit" class="btn primary" style="padding:var(--space-md) var(--space-xl);font-size:1.1rem;">Submit Timesheet</button>
    <div id="submitStatus" class="mt-md"></div>
  </section>
</form>
```

  </main>

  <div id="personalModal" class="modal">
    <div class="modal-content">
      <h3>Add Personal Time</h3>
      <div class="form-group">
        <label class="label">Hours</label>
        <input type="number" id="personalHours" class="input" step="0.25" min="0" value="8.00">
      </div>
      <div class="modal-buttons">
        <button type="button" class="btn primary" id="confirmPersonal">Add</button>
        <button type="button" class="btn ghost" id="cancelPersonal">Cancel</button>
      </div>
    </div>
  </div>

  <div id="stipendModal" class="modal">
    <div class="modal-content">
      <h3>Add Stipend</h3>
      <div class="form-group">
        <label class="label">Amount ($)</label>
        <input type="number" id="stipendAmount" class="input" step="0.01" min="0" placeholder="0.00">
      </div>
      <div class="form-group">
        <label class="label">GL Account</label>
        <select id="stipendGL" class="input">
          <option value="">-- Select GL Account --</option>
          <option value="1000-122-5100-0000">Select Board — 1000-122-5100-0000</option>
          <option value="1000-129-5100-0000">Administration — 1000-129-5100-0000</option>
          <option value="1000-135-5100-0000">Accounting — 1000-135-5100-0000</option>
          <option value="1000-141-5100-0000">Assessors — 1000-141-5100-0000</option>
          <option value="1000-145-5100-0000">Legal — 1000-145-5100-0000</option>
          <option value="1000-149-5100-0000">Treasurer/Collector — 1000-149-5100-0000</option>
          <option value="1000-161-5100-0000">Town Clerk — 1000-161-5100-0000</option>
          <option value="1000-171-5100-0000">Conservation — 1000-171-5100-0000</option>
          <option value="1000-175-5100-0000">Planning Board — 1000-175-5100-0000</option>
          <option value="1000-176-5100-0000">Zoning Board of Appeals — 1000-176-5100-0000</option>
          <option value="1000-192-5100-0000">Facilities — 1000-192-5100-0000</option>
          <option value="1000-210-5100-0000">Police — 1000-210-5100-0000</option>
          <option value="1000-220-5100-0000">Fire — 1000-220-5100-0000</option>
          <option value="1000-241-5100-0000">Land Use/Building — 1000-241-5100-0000</option>
          <option value="1000-420-5100-0000">Public Works — 1000-420-5100-0000</option>
          <option value="1000-541-5100-0000">Senior Center/COA — 1000-541-5100-0000</option>
          <option value="1000-610-5100-0000">Library — 1000-610-5100-0000</option>
        </select>
      </div>
      <div class="modal-buttons">
        <button type="button" class="btn primary" id="confirmStipend">Add</button>
        <button type="button" class="btn ghost" id="cancelStipend">Cancel</button>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <p>&copy; 2025 Town of Hubbardston, MA</p>
  </footer>

<script>
const EMPLOYEES=[{id:3018,name:"Afonso Albert",rate:16.13,payType:"hourly"},{id:3216,name:"Afonso Nancy",rate:10,payType:"hourly"},{id:24,name:"Anderson Richard J",rate:8.96,payType:"hourly"},{id:2913,name:"Ares Erik R",rate:23.12,payType:"hourly"},{id:3009,name:"Ares James P",rate:22.35,payType:"hourly"},{id:2955,name:"Barbera Christine M",rate:31.82,payType:"hourly"},{id:3130,name:"Begin Betty Jane",rate:15,payType:"hourly"},{id:3110,name:"Blood Donald J",rate:36.82,payType:"hourly"},{id:3234,name:"Boudreau Nathan R",rate:115566,payType:"salary"},{id:3276,name:"Bourgeois Daniel F",rate:25,payType:"hourly"},{id:3236,name:"Bowley David D",rate:16.13,payType:"hourly"},{id:3181,name:"Brady Robert M",rate:16.89,payType:"hourly"},{id:3165,name:"Breagy Richard",rate:27.74,payType:"hourly"},{id:3215,name:"Breagy Susan",rate:20,payType:"hourly"},{id:3211,name:"Bresciani Andrew P",rate:28.36,payType:"hourly"},{id:3091,name:"Brown Travis M",rate:94242,payType:"salary"},{id:3277,name:"Capps Michael A",rate:22,payType:"hourly"},{id:2695,name:"Casey Troy A",rate:34.28,payType:"hourly"},{id:3226,name:"Champagne Robert",rate:23.46,payType:"hourly"},{id:3291,name:"Chatterton Samantha Lee",rate:32.5,payType:"hourly"},{id:3205,name:"Colwell Bryan R",rate:17.84,payType:"hourly"},{id:3220,name:"Como Jeannine",rate:20,payType:"hourly"},{id:3252,name:"Connery Julia A",rate:18,payType:"hourly"},{id:1034,name:"Coppola Anthony T",rate:5,payType:"hourly"},{id:3233,name:"Cormier Elizabeth",rate:15,payType:"hourly"},{id:2836,name:"Couture Ryan P",rate:25,payType:"hourly"},{id:3261,name:"Cunningham Brian F",rate:50,payType:"hourly"},{id:3e3,name:"DeMalia John A Jr",rate:18.84,payType:"hourly"},{id:3283,name:"Dion Trevor R",rate:15.62,payType:"hourly"},{id:2567,name:"Dixson James F",rate:24.67,payType:"hourly"},{id:1156,name:"Dixson Tina C",rate:22.21,payType:"hourly"},{id:2532,name:"Doane William",rate:9.28,payType:"hourly"},{id:3297,name:"Ellis James",rate:20,payType:"hourly"},{id:3186,name:"Fontaine Kayla A",rate:20.68,payType:"hourly"},{id:2722,name:"Forte Robert K",rate:37.68,payType:"hourly"},{id:3180,name:"Gallant Edward R",rate:16.13,payType:"hourly"},{id:2997,name:"Gemborys Eric A",rate:25,payType:"hourly"},{id:3239,name:"Goewey Anne",rate:17.57,payType:"hourly"},{id:3168,name:"Goguen Neil B",rate:28.42,payType:"hourly"},{id:3230,name:"Goldsmith Gregory",rate:22,payType:"hourly"},{id:3255,name:"Gonzalez Izaiah",rate:17.43,payType:"hourly"},{id:3033,name:"Goscila Jeremy D",rate:28.56,payType:"hourly"},{id:3221,name:"Gosson Edward M",rate:20,payType:"hourly"},{id:3248,name:"Gosson Wendy",rate:18,payType:"hourly"},{id:2726,name:"Green Joyce E",rate:15.31,payType:"hourly"},{id:3266,name:"Green Melody",rate:56610,payType:"salary"},{id:3237,name:"Green Richard W",rate:22,payType:"hourly"},{id:2801,name:"Halkola James F",rate:23.46,payType:"hourly"},{id:2708,name:"Hamel Dennis C",rate:23.3,payType:"hourly"},{id:3155,name:"Hardaker Sharon A",rate:18.92,payType:"hourly"},{id:3256,name:"Hawkins Leroy",rate:20,payType:"hourly"},{id:2698,name:"Hayes Robert Jr",rate:100462,payType:"salary"},{id:3295,name:"Horne David",rate:50,payType:"hourly"},{id:3218,name:"Horvath Kenneth",rate:22,payType:"hourly"},{id:3254,name:"Hulette John",rate:17.52,payType:"hourly"},{id:3281,name:"Isgro Wendy",rate:15,payType:"hourly"},{id:3222,name:"Jeneski Linda",rate:18,payType:"hourly"},{id:3260,name:"Johnson Robert A",rate:50,payType:"hourly"},{id:3200,name:"Johnson Stanley H",rate:15.51,payType:"hourly"},{id:2937,name:"Kaldera Bella M",rate:15,payType:"hourly"},{id:3272,name:"Kamataris William",rate:22,payType:"hourly"},{id:3299,name:"Kelley Royce J",rate:23.98,payType:"hourly"},{id:3214,name:"Kohlstrom Beverly",rate:18,payType:"hourly"},{id:3243,name:"LaBelle Michael",rate:19.05,payType:"hourly"},{id:3189,name:"Lafayette Rene M",rate:20,payType:"hourly"},{id:3175,name:"Lamoureux Patricia",rate:15,payType:"hourly"},{id:3225,name:"Lanciani Robert",rate:41.09,payType:"hourly"},{id:2957,name:"Larson Shonna L",rate:15,payType:"hourly"},{id:3257,name:"LeBlanc Wendy",rate:22.03,payType:"hourly"},{id:3244,name:"Leroux Mary",rate:69993,payType:"salary"},{id:3219,name:"Listovitch Cynthia",rate:18,payType:"hourly"},{id:3238,name:"Lowe Patricia Erin",rate:23.38,payType:"hourly"},{id:3119,name:"Mabardy Mitchell F",rate:20.82,payType:"hourly"},{id:3250,name:"Malcomson Evonne",rate:18,payType:"hourly"},{id:3016,name:"Malnati Nicholas",rate:23.46,payType:"hourly"},{id:3290,name:"McDaniel Isaiah",rate:16.89,payType:"hourly"},{id:3287,name:"McDonald Brendan R",rate:23.98,payType:"hourly"},{id:3263,name:"Michals Lorraine",rate:15,payType:"hourly"},{id:3279,name:"Moses Leeanne",rate:23.38,payType:"hourly"},{id:2615,name:"O'Donnell Judith L",rate:4.75,payType:"hourly"},{id:3294,name:"Osowski Liberty",rate:18,payType:"hourly"},{id:3253,name:"Page Deborah",rate:18,payType:"hourly"},{id:3132,name:"Parker Michael C",rate:18.84,payType:"hourly"},{id:3171,name:"Payson James V",rate:16.89,payType:"hourly"},{id:3166,name:"Perron Nancy A",rate:22.03,payType:"hourly"},{id:3076,name:"Pervier Florence",rate:8,payType:"hourly"},{id:3249,name:"Pervier Paul",rate:20,payType:"hourly"},{id:3193,name:"Pierce Michael R",rate:20.68,payType:"hourly"},{id:3024,name:"Provencal Claudia G",rate:25,payType:"hourly"},{id:3274,name:"Rish Sara",rate:24.01,payType:"hourly"},{id:3049,name:"Rogan Nancy",rate:15,payType:"hourly"},{id:3296,name:"Saint Sadie",rate:22,payType:"hourly"},{id:3267,name:"Scarpato Samuel",rate:23.5,payType:"hourly"},{id:3259,name:"Seitz Benjamin",rate:25.49,payType:"hourly"},{id:3245,name:"Shampine Jeffrey G",rate:22,payType:"hourly"},{id:3143,name:"Shaughnessy Mary Ellen",rate:15,payType:"hourly"},{id:3289,name:"Siciliano Brian",rate:22,payType:"hourly"},{id:3235,name:"Siequist Shaun",rate:23,payType:"hourly"},{id:2732,name:"Sweeney Darrell M",rate:20,payType:"hourly"},{id:3093,name:"Sweeney Paul F",rate:17.57,payType:"hourly"},{id:3206,name:"Theriault Phillip J Jr",rate:17.8,payType:"hourly"},{id:3223,name:"Tonet Edward T",rate:20,payType:"hourly"},{id:3282,name:"Tyler Lois Ann",rate:15,payType:"hourly"},{id:3229,name:"Vincent James",rate:15.92,payType:"hourly"},{id:2848,name:"Vincent Kathleen Mary",rate:15,payType:"hourly"},{id:3275,name:"Wade Alexander",rate:45,payType:"hourly"},{id:3293,name:"White Tina",rate:22.03,payType:"hourly"},{id:3025,name:"Whitney Brianna H",rate:15.3,payType:"hourly"},{id:2750,name:"Whitney Carol W",rate:15,payType:"hourly"},{id:1045,name:"Wilkinson Lynn R",rate:15,payType:"hourly"},{id:3116,name:"Wilkinson Taylor",rate:29.4,payType:"hourly"},{id:3217,name:"Williams Lorraine",rate:18,payType:"hourly"},{id:3288,name:"Winchester Kenneth James",rate:23.98,payType:"hourly"},{id:2716,name:"Withycombe William R",rate:15,payType:"hourly"},{id:3123,name:"Wolfe Karen M",rate:8,payType:"hourly"},{id:3286,name:"Woodard Andrew P",rate:23.98,payType:"hourly"},{id:3077,name:"Woodward Patricia A",rate:12.75,payType:"hourly"},{id:3231,name:"Wright Lauren",rate:23.1,payType:"hourly"},{id:3292,name:"Wright Zakary Richard",rate:23.46,payType:"hourly"},{id:3285,name:"Young Hunter Allan",rate:17.57,payType:"hourly"}];
let ce=null;
const $=s=>document.querySelector(s),cu=n=>new Intl.NumberFormat('en-US',{style:'currency',currency:'USD'}).format(Number(n||0));
function sm(t,y='info'){const m=$('#systemMsg');if(!m)return;m.className='alert '+y;m.textContent=t;m.style.display='block';setTimeout(()=>m.style.display='none',5e3)}
function ar(d,s,e,h,ty,de){const tb=$('#timeBody');if(!tb)return;const tr=document.createElement('tr');tr.innerHTML='<td><input type=date class=input value="'+d+'"></td><td><input type=time class=input value="'+s+'"></td><td><input type=time class=input value="'+e+'"></td><td><input type=number step=0.25 min=0 class=input value="'+h+'"></td><td><select class=input><option'+(ty=='Regular'?' selected':'')+'>Regular</option><option'+(ty=='Sick'?' selected':'')+'>Sick</option><option'+(ty=='Vacation'?' selected':'')+'>Vacation</option><option'+(ty=='Personal'?' selected':'')+'>Personal</option><option'+(ty=='Stipend'?' selected':'')+'>Stipend</option></select></td><td><input class=input value="'+de+'"></td><td><button class="btn btn-danger" style="padding:4px 8px;font-size:12px;">Remove</button></td>';tb.appendChild(tr);tr.querySelector('button').onclick=()=>{tr.remove();ct()};tr.querySelectorAll('input,select').forEach(i=>i.oninput=ct)}
function ct(){let tt=0,r=0,si=0,v=0,p=0,st=0;document.querySelectorAll('#timeBody tr').forEach(rw=>{const h=+rw.children[3].querySelector('input').value||0,ty=rw.children[4].querySelector('select').value;if(h){tt+=h;if(ty=='Regular')r+=h;else if(ty=='Sick')si+=h;else if(ty=='Vacation')v+=h;else if(ty=='Personal')p+=h;else if(ty=='Stipend')st+=h}});$('#totalHours').textContent=tt.toFixed(2);$('#sumRegular').textContent=r.toFixed(2);$('#sumSick').textContent=si.toFixed(2);$('#sumVacation').textContent=v.toFixed(2);$('#sumPersonal').textContent=p.toFixed(2);$('#sumStipend').textContent=st.toFixed(2);let pa=0;if(ce)pa=ce.payType=='salary'?ce.rate/26:(r+si+v+p+st)*ce.rate;$('#grossPay').textContent=cu(pa)}
EMPLOYEES.forEach(e=>{const o=document.createElement('option');o.value=e.name;$('#employeeList').appendChild(o)});
$('#employeeSearch').oninput=function(){const e=EMPLOYEES.find(x=>x.name.toLowerCase()==this.value.trim().toLowerCase());if(e){ce=e;$('#employeeDetails').style.display='block';$('#empId').textContent=e.id;$('#empName').textContent=e.name;$('#rate').textContent=(e.payType=='salary'?cu(e.rate)+' annual':cu(e.rate)+'/hr');ct();sm('Selected: '+e.name,'success')}};
$('#addRowBtn').onclick=()=>ar('','','','','Regular','');
$('#sickBtn').onclick=()=>{if(!ce){sm('Select employee first','error');return}ar(new Date().toISOString().slice(0,10),'','','8','Sick','Sick Day');ct();sm('Sick Day added','success')};
$('#vacationBtn').onclick=()=>{if(!ce){sm('Select employee first','error');return}ar(new Date().toISOString().slice(0,10),'','','8','Vacation','Vacation Day');ct();sm('Vacation Day added','success')};
$('#personalBtn').onclick=()=>{if(!ce){sm('Select employee first','error');return}$('#personalModal').classList.add('active')};
$('#confirmPersonal').onclick=()=>{const h=$('#personalHours').value;if(h&&+h>0){ar(new Date().toISOString().slice(0,10),'','',h,'Personal','Personal Time');ct();$('#personalModal').classList.remove('active');sm('Personal Time added','success')}else sm('Enter valid hours','error')};
$('#cancelPersonal').onclick=()=>$('#personalModal').classList.remove('active');
$('#stipendBtn').onclick=()=>{if(!ce){sm('Select employee first','error');return}$('#stipendModal').classList.add('active')};
$('#confirmStipend').onclick=()=>{const a=$('#stipendAmount').value,g=$('#stipendGL').value;if(a&&+a>0&&g){const gl=$('#stipendGL').options[$('#stipendGL').selectedIndex].text;ar(new Date().toISOString().slice(0,10),'','',a,'Stipend','Stipend $'+a+' - '+gl);ct();$('#stipendModal').classList.remove('active');$('#stipendAmount').value='';$('#stipendGL').value='';sm('Stipend added','success')}else sm('Enter valid amount and GL code','error')};
$('#cancelStipend').onclick=()=>$('#stipendModal').classList.remove('active');
$('#personalModal').onclick=e=>{if(e.target.id=='personalModal')e.target.classList.remove('active')};
$('#stipendModal').onclick=e=>{if(e.target.id=='stipendModal')e.target.classList.remove('active')};
$('#clearAllBtn').onclick=()=>{if(confirm('Clear all?')){$('#timeBody').innerHTML='';ar('','','','','Regular','');ct()}};
$('#themeToggle').onclick=()=>{const t=document.documentElement.getAttribute('data-theme')=='dark'?'light':'dark';document.documentElement.setAttribute('data-theme',t);$('#themeToggle').textContent=t=='dark'?'Light':'Dark'};
ar('','','','','Regular','');sm('Ready. Select employee.','info');
</script>

</body>
</html>
